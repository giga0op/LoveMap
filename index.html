<!DOCTYPE html>
<html lang="ka">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Our Love Map Journey</title>

<style>
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
    height: 100vh;
    width: 100vw;
    overflow: hidden;
    font-family: 'Segoe UI', sans-serif;
    background: #000;
}

.background {
    position: fixed;
    inset: 0;
    background: url("1.png") center / cover no-repeat;
    z-index: -1;
}

.map-container {
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
}

.map-wrapper {
    position: relative;
}

.map {
    max-width: 90vw;
    max-height: 80vh;
    border-radius: 20px;
    filter: drop-shadow(0 0 40px rgba(255,120,200,0.4));
}

.pin-trigger {
    position: absolute;
    width: 70px;
    height: 70px;
    border-radius: 50%;
    cursor: pointer;
    background: rgba(255,120,200,0.25);
    animation: pulse 2s infinite;
}

@keyframes pulse {
    0% { box-shadow: 0 0 0 0 rgba(255,120,200,0.7); }
    70% { box-shadow: 0 0 0 15px rgba(255,120,200,0); }
    100% { box-shadow: 0 0 0 0 rgba(255,120,200,0); }
}

.pin-hit {
    animation: bounce 0.5s ease;
}
@keyframes bounce {
    0%,100% { transform: scale(1); }
    50% { transform: scale(1.4); }
}

#motorcycle {
    position: fixed;
    font-size: 35px;
    display: none;
    pointer-events: none;
    z-index: 100;
    transition: all 1.2s cubic-bezier(0.45,0.05,0.55,0.95);
}

.modal {
    position: fixed;
    width: 300px;
    padding: 15px;
    background: rgba(255,255,255,0.85);
    backdrop-filter: blur(15px);
    border-radius: 25px;
    box-shadow: 0 15px 45px rgba(0,0,0,0.3);
    display: none;
    opacity: 0;
    transform: translateY(10px) scale(0.9);
    transition: all 0.35s ease;
    z-index: 1000;
}

.modal.active {
    display: block;
    opacity: 1;
    transform: translateY(0) scale(1);
}

.slider-container {
    position: relative;
    width: 100%;
    height: 220px;
    overflow: hidden;
    border-radius: 18px;
    margin-bottom: 12px;
}

.slider-img {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    opacity: 0;
    transition: opacity 0.45s ease-in-out;
    will-change: opacity;
}

.slider-img.active {
    opacity: 1;
    z-index: 2;
}

.controls {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.btn {
    width: 42px;
    height: 42px;
    border-radius: 50%;
    border: none;
    cursor: pointer;
    background: linear-gradient(135deg,#ff78c8,#ffb2e0);
    color: white;
    font-size: 18px;
}

.close-btn {
    position: absolute;
    top: -10px;
    right: -10px;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    border: none;
    background: #ff4b4b;
    color: white;
    cursor: pointer;
}

.heart {
    position: fixed;
    bottom: -20px;
    pointer-events: none;
    animation: floatUp linear forwards;
}

@keyframes floatUp {
    to { transform: translateY(-110vh); opacity: 0; }
}

@media (max-width: 768px) {
    body * { display: none !important; }
    body::before {
        content: "·Éí·Éê·ÉÆ·É°·Éî·Éú·Éò ·Éô·Éù·Éõ·Éû·Éò·É£·É¢·Éî·É†·Éò·Éì·Éê·Éú üòÑüíª‚ù§Ô∏è";
        position: fixed;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        background: #ff78c8;
        color: white;
        font-size: 24px;
        text-align: center;
    }
}
</style>
</head>

<body>

<audio id="mySong" loop>
    <source src="love_song.mp3" type="audio/mpeg">
</audio>

<div class="background"></div>
<div id="motorcycle">üõµ</div>

<div class="map-container">
    <div class="map-wrapper" id="mapWrapper">
        <img src="2.png" class="map">

        <div class="pin-trigger" style="top:55%;left:25%" onclick="handleJourney(event,'batumi')"></div>
        <div class="pin-trigger" style="top:57%;left:48%" onclick="handleJourney(event,'tbilisi')"></div>
        <div class="pin-trigger" style="top:37%;left:59%" onclick="handleJourney(event,'gudauri')"></div>
        <div class="pin-trigger" style="top:56%;left:68%" onclick="handleJourney(event,'telavi')"></div>
    </div>
</div>

<div class="modal" id="photoModal">
    <button class="close-btn" onclick="closeModal()">‚úï</button>

    <div class="slider-container">
        <img id="imgA" class="slider-img active">
        <img id="imgB" class="slider-img">
    </div>

    <div class="controls">
        <button class="btn" onclick="prevImg()">‚ùÆ</button>
        <span id="imgCounter" style="color:#ff78c8;font-weight:bold"></span>
        <button class="btn" onclick="nextImg()">‚ùØ</button>
    </div>
</div>

<script>
const album = {
batumi: ["bt3.jpeg", "bt2.jpeg", "bt5.jpeg", "bt4.jpeg", "bt1.jpeg"],
tbilisi: ["Untitled.jpg", "tb1.jpeg", "tb2.jpeg"],
gudauri: ["g1.jpeg", "g2.jpeg", "g3.jpeg"],
telavi: ["te1.jpeg", "te2.jpeg"]
};

let currentAlbum = [];
let currentIndex = 0;
let firstClick = true;

const modal = document.getElementById("photoModal");
const counter = document.getElementById("imgCounter");
const moto = document.getElementById("motorcycle");
const song = document.getElementById("mySong");

const imgA = document.getElementById("imgA");
const imgB = document.getElementById("imgB");
let activeImg = imgA;
let hiddenImg = imgB;

function handleJourney(e, city) {
    if (song.paused) song.play().catch(()=>{});
    closeModal();

    const pin = e.currentTarget;
    const r = pin.getBoundingClientRect();
    const x = r.left + r.width/2 - 20;
    const y = r.top + r.height/2 - 20;

    if (firstClick) {
        moto.style.left = x+"px";
        moto.style.top = y+"px";
        moto.style.display = "block";
        firstClick = false;
        openSlider(x,y,city);
    } else {
        const cx = parseInt(moto.style.left)||0;
        moto.style.transform = x > cx ? "scaleX(1)" : "scaleX(-1)";
        moto.style.left = x+"px";
        moto.style.top = y+"px";

        setTimeout(()=>{
            pin.classList.add("pin-hit");
            setTimeout(()=>pin.classList.remove("pin-hit"),500);
            openSlider(x,y,city);
        },1200);
    }
}

function openSlider(x,y,city) {
    currentAlbum = album[city];
    currentIndex = 0;
    updateImage(true);
    modal.style.left = (x-120)+"px";
    modal.style.top = (y-280)+"px";
    modal.classList.add("active");
}

function closeModal() {
    modal.classList.remove("active");
}

function updateImage(immediate=false) {
    hiddenImg.src = currentAlbum[currentIndex];

    if (immediate) {
        activeImg.src = hiddenImg.src;
        counter.innerText = `${currentIndex+1} / ${currentAlbum.length}`;
        return;
    }

    hiddenImg.onload = () => {
        hiddenImg.classList.add("active");
        activeImg.classList.remove("active");
        [activeImg, hiddenImg] = [hiddenImg, activeImg];
        counter.innerText = `${currentIndex+1} / ${currentAlbum.length}`;
    };
}

function nextImg() {
    currentIndex = (currentIndex+1)%currentAlbum.length;
    updateImage();
}

function prevImg() {
    currentIndex = (currentIndex-1+currentAlbum.length)%currentAlbum.length;
    updateImage();
}

// ·Éí·É£·Éö·Éî·Éë·Éò
setInterval(()=>{
    const h=document.createElement("div");
    h.className="heart";
    h.innerHTML=["‚ù§","üíñ","üíï","‚ú®"][Math.floor(Math.random()*4)];
    h.style.left=Math.random()*100+"vw";
    h.style.animationDuration=(Math.random()*3+4)+"s";
    document.body.appendChild(h);
    setTimeout(()=>h.remove(),6000);
},500);

// ·É†·É£·Éô·Éò·É° ·É¢·Éò·Éï·É¢·Éò·Éï·Éò
const wrapper=document.getElementById("mapWrapper");
let a=0;
(function animate(){
    a+=0.02;
    wrapper.style.transform=`translateY(${Math.sin(a)*8}px)`;
    requestAnimationFrame(animate);
})();
</script>

</body>
</html>
